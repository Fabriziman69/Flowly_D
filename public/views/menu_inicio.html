<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Calendario Menstrual</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../css/style_menu.css">
</head>
<body>
    <header>
        <div class="header-particles" id="headerParticles"></div>
        <nav class="navbar navbar-expand-lg navbar-light p-0 pt-2">
            <div class="container-fluid flex-column align-items-start align-items-lg-center">
                
                <div class="d-lg-none w-100 px-3 mb-1">
                    <span class="text-white fw-bold fs-5">Mi Ciclo</span>
                </div>

                <div class="w-100">
                    <div class="menu-scroll w-100 d-flex gap-2 py-2 px-2">
                        
                        <div class="dropdown nav-item-custom">
                            <button class="chip nav-button dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                <span class="material-symbols-outlined">account_circle</span>
                                <span id="nav-username">Usuario</span>
                            </button>
                            <ul class="dropdown-menu shadow border-0 mt-2">
                                <li><a class="dropdown-item" href="#" data-bs-toggle="offcanvas" data-bs-target="#offcanvasPerfil">
                                    <span class="material-symbols-outlined me-2">person</span> Perfil
                                </a></li>
                                <li><a class="dropdown-item" href="#" id="btnLogoutMobile">
                                    <span class="material-symbols-outlined me-2">logout</span> Salir
                                </a></li>
                            </ul>
                        </div>

                        <button type="button" class="chip nav-button nav-item-custom" id="btn_ciclo">
                            <span class="material-symbols-outlined">settings_accessibility</span>
                            Ciclo
                        </button>

                        <button type="button" class="chip nav-button nav-item-custom" id="btn_registro">
                            <span class="material-symbols-outlined">edit_calendar</span>
                            Síntomas
                        </button>

                        <button type="button" class="chip nav-button active nav-item-custom" id="btn_calendario">
                            <span class="material-symbols-outlined">calendar_month</span>
                            Calendario
                        </button>

                        <button type="button" class="chip nav-button nav-item-custom" id="btn_estadisticas">
                            <span class="material-symbols-outlined">bar_chart</span>
                            Estadísticas
                        </button>

                        <button type="button" class="chip nav-button nav-item-custom" id="btn_informativa">
                            <span class="material-symbols-outlined">local_library</span>
                            Info Salud
                        </button>

                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container pt-4 pb-5">
        
        <div id="seccion-calendario" class="contenido-seccion fade-in">
            <h2 class="title mb-4 text-center">Calendario Menstrual</h2>
            <div id='calendar' class="shadow-sm rounded bg-white p-2"></div>
        </div>

        <div id="seccion-estadisticas" class="contenido-seccion d-none fade-in">
            <h2 class="title mb-4">Estadísticas de tu Ciclo</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card h-100 border-0">
                        <div class="card-body text-center">
                            <span class="material-symbols-outlined text-primary mb-2" style="font-size: 2rem;">timelapse</span>
                            <h5 class="card-label">Duración Promedio</h5>
                            <p class="card-value" id="duracion-promedio">-- días</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 border-0">
                        <div class="card-body text-center">
                            <span class="material-symbols-outlined text-success mb-2" style="font-size: 2rem;">today</span>
                            <h5 class="card-label">Ciclo Actual</h5>
                            <p class="card-value text-success" id="ciclo-actual">Día --</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 border-0">
                        <div class="card-body text-center">
                            <span class="material-symbols-outlined text-danger mb-2" style="font-size: 2rem;">event_busy</span>
                            <h5 class="card-label">Próximo Periodo</h5>
                            <p class="card-value text-danger" id="proximo-periodo">-- días</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mensaje-abajo mt-5">
                <span class="material-symbols-outlined" style="font-size: 24px; color: var(--primary-color);">spa</span>
                <div class="text-start">
                    <p class="mb-1 fw-bold">IMPORTANCIA DEL REGISTRO</p>
                    <p class="mb-0 small">Llevar un registro te ayuda a comprender tu cuerpo, identificar patrones y detectar irregularidades a tiempo.</p>
                </div>
            </div>
        </div>

        <div id="seccion-informativa" class="contenido-seccion d-none fade-in">
            <h2 class="title mb-4">Salud Menstrual</h2>

            <div id="consejo-diario" class="alert alert-pink text-center fs-6 fw-semibold shadow-sm border-0 mb-4">
                Cargando consejo...
            </div>

            <div id="contenedor-tarjetas-info" class="row mb-4">
                <div class="col-12 text-center text-muted">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p>Cargando información...</p>
                </div>
            </div>

            <div class="accordion shadow-sm rounded overflow-hidden" id="acordeonFases">
                </div>
        </div>
    </main>

    <div class="modal fade" id="modalRegistroInicial" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header text-white" style="background: var(--primary-color);">
                    <h5 class="modal-title">Configuración de Ciclo</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="formRegistroInicial">
                        <div class="mb-3">
                            <label for="ultimoPeriodo" class="form-label">Primer día del último periodo:</label>
                            <input type="date" class="form-control" id="ultimoPeriodo" required>
                        </div>
                        <div class="mb-3">
                            <label for="duracionCiclo" class="form-label">Duración del ciclo (días):</label>
                            <input type="number" class="form-control" id="duracionCiclo" min="21" max="35" value="28" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-primary w-100 rounded-pill" id="btnGuardarRegistroInicial">Guardar Ciclo</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalCicloExistente" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header bg-light border-0">
                    <h5 class="modal-title text-primary fw-bold">Estado del Ciclo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center p-4">
                    <span class="material-symbols-outlined text-primary mb-3" style="font-size: 40px;">event_repeat</span>
                    
                    <h4 class="fw-bold text-dark mb-2">Ciclo Activo</h4>
                    <p class="text-muted mb-4">Actualmente estamos siguiendo tu ciclo anterior.</p>

                    <hr class="my-4">

                    <h6 class="fw-bold text-secondary mb-3">¿Comenzó tu periodo nuevamente?</h6>
                    <p class="small text-muted mb-3">Registra el inicio para recalcular tus fechas.</p>
                    
                    <button type="button" class="btn btn-primary w-100 rounded-pill py-2" id="btnIniciarNuevoCiclo">
                        <span class="material-symbols-outlined align-middle me-2" style="font-size: 18px;">water_drop</span>
                        Registrar Nuevo Periodo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalSintoma" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header text-white" style="background: linear-gradient(to right, var(--primary-color), var(--secondary-color));">
                    <h5 class="modal-title">Registrar Síntoma</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="formSintoma">
                        <div class="mb-3">
                            <label for="fechaSintoma" class="form-label fw-bold text-secondary">Fecha:</label>
                            <input type="date" class="form-control bg-light" id="fechaSintoma" required>
                        </div>

                        <div class="mb-3">
                            <label for="selectSintoma" class="form-label fw-bold text-secondary">¿Qué sientes hoy?</label>
                            <select class="form-select" id="selectSintoma">
                                <option value="" selected disabled>Cargando síntomas...</option>
                            </select>
                        </div>

                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="checkOtroSintoma">
                            <label class="form-check-label text-muted small" for="checkOtroSintoma">No encuentro mi síntoma</label>
                        </div>

                        <div class="mb-4 d-none" id="divNuevoSintoma">
                            <input type="text" class="form-control border-primary" id="inputNuevoSintoma" placeholder="Escribe aquí (ej: Mareos)">
                        </div>

                        <div class="mb-2">
                            <label class="form-label fw-bold text-secondary">Intensidad</label>
                            <input type="range" class="form-range" min="1" max="5" id="intensidadSintoma" value="2">
                            <div class="d-flex justify-content-between small text-muted">
                                <span>Leve</span>
                                <span>Fuerte</span>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-light text-muted" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary px-4 rounded-pill" id="btnGuardarSintoma">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasPerfil">
        <div class="offcanvas-header bg-light">
            <h5 class="offcanvas-title">Mi Perfil</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body text-center pt-5">
            <span class="material-symbols-outlined text-secondary mb-3" style="font-size: 4rem;">account_circle</span>
            <h4 id="perfil-username">Usuario</h4>
            <p class="text-muted mb-4" id="perfil-email">...</p>
            <hr>
            <a href="#" id="btnLogout" class="btn btn-outline-danger w-100 rounded-pill mt-3">Cerrar Sesión</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.19/index.global.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../js/script_menu.js"></script>
</body>
</html>